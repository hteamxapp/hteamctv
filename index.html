<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HTeam MMO</title>
  <style>
    body {
      background: black;
      color: white;
      font-family: sans-serif;
      text-align: center;
      margin: 0;
      padding: 0;
    }
    .title {
      font-size: 40px;
      margin: 30px 0 20px;
      color: transparent;
      background: linear-gradient(to right, #ffcc00, #ff3300);
      -webkit-background-clip: text;
      text-shadow: 2px 2px 4px red;
      font-family: 'Comic Sans MS', cursive;
    }

.slider-container {
  width: 100vw;
  max-width: 100%;
  overflow: hidden;
  position: relative;
  border: 2px solid white;
  touch-action: pan-y; /* Cho phÃ©p vuá»‘t ngang */
}

.slider-track {
  display: flex;
  transition: transform 0.5s ease;
}

.slider-track img {
  width: 100vw;
  height: auto;
  object-fit: contain;
  flex-shrink: 0;
}

    @keyframes slide {
      0%   { transform: translateX(0%); }
      33%  { transform: translateX(-100%); }
      66%  { transform: translateX(-200%); }
      100% { transform: translateX(0%); }
    }

    input, button, textarea {
      padding: 12px;
      font-size: 16px;
      width: 80%;
      margin: 10px auto;
      border-radius: 8px;
      display: block;
    }
    button {
      cursor: pointer;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 16px;
    }
    th, td {
      border: 1px solid white;
      padding: 8px;
      font-size: 14px;
    }
    .footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: #000;
      display: flex;
      justify-content: space-around;
      padding: 10px 0;
    }
    .footer button {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
    }
    .hidden { display: none; }
  </style>
</head>
<body>
<!-- Splash Screen -->
<div id="splashScreen" style="position:fixed; inset:0; background:#ff0; display:flex; flex-direction:column; align-items:center; justify-content:center; z-index:9999;">
  <img src="hteammmo.png" style="max-width:90%; height:auto;" />
  <div id="loadingText" style="font-size: 20px; margin-top: 20px;"></div>
</div>

<script>
let progress = 1;
const loadingText = document.getElementById("loadingText");
const splash = document.getElementById("splashScreen");

const splashInterval = setInterval(() => {
  loadingText.innerHTML = `Äang táº£i tiáº¿n trÃ¬nh dá»¯ liá»‡u<br><strong>${progress}%</strong>`;
  progress++;

  if (progress > 100) {
    clearInterval(splashInterval);
    splash.style.display = "none";
    document.getElementById("loginScreen").classList.remove("hidden");
  }
}, 50); // 5 giÃ¢y = 50ms * 100
</script>
</div>
<audio id="bgMusic" src="hteammmo.mp3" loop></audio>

<div id="loginScreen">
  <h1 class="title">HTeam MMO</h1>
  <input id="usernameInput" placeholder="TÃªn ngÆ°á»i dÃ¹ng">
  <input id="passwordInput" type="password" placeholder="Máº­t kháº©u">
  <button onclick="continueToMain()">ÄÄ‚NG NHáº¬P</button>
  <div style="text-align: left; margin: 20px 10%; color: #ccc;">
    <b>ÄÄƒng kÃ­ MMO vá»›i HR</b><br>
    Â» Telesale: Gá»i xÃ¡c nháº­n Ä‘Æ¡n cho khÃ¡ch<br>
    Â» Saler: LÃªn Ä‘Æ¡n, tÃ¬m khÃ¡ch<br>
    Â» CTV HTeam: Giá»›i thiá»‡u dá»‹ch vá»¥ tÃ¬m kiáº¿m khÃ¡ch dÃ¹ng dá»‹ch vá»¥ HTeam<br>
    Â» Tool Auto: Treo mÃ¡y kiáº¿m xu...
  </div>
  <a href="https://m.me/viethung2002tienhai" target="_blank">
    <button style="background:#0084ff; color:white;">ÄÄ‚NG KÃ</button>
  </a>
</div>

<div id="mainScreen" class="hidden">
  <h1 class="title">HTeam MMO</h1>

 <!-- Banner Slider -->
<div class="slider-container" id="sliderContainer">
  <div class="slider-track" id="sliderTrack">
    <img src="banner1.png" alt="Banner 1">
    <img src="banner2.png" alt="Banner 2">
    <img src="banner3.png" alt="Banner 3">
  </div>
</div>

  <div style="margin-top: 20px; font-size: 18px;">
    Version: 1.2<br>Build: 1.1<br>Founder: Nguyá»…n Viá»‡t HÃ¹ng<br>Â©2021
  </div>
  <div style="margin-top: 30px;">
    <button onclick="openGiftCode()" style="background: gold; font-weight: bold; font-size: 20px;">Gift Code ğŸ</button>
    <button onclick="openNotification()" style="background: gold; font-weight: bold; font-size: 20px;">ThÃ´ng BÃ¡o ğŸ“¢</button>
    <button onclick="openEvent()" style="background: gold; font-weight: bold; font-size: 20px;">Sá»± Kiá»‡n ğŸ†</button>
  </div>
  <div class="footer">
    <button onclick="alert('ChÆ°a cáº­p nháº­t')">ğŸ®</button>
    <button onclick="showIncome()">ğŸ“Š</button>
    <button onclick="showWithdraw()">ğŸ’¸</button>
    <button onclick="showSettings()">âš™ï¸</button>
    <button onclick="goHome()">H</button>
  </div>
</div>

<div id="screen2" class="hidden">
  <h2>Thu nháº­p cá»§a báº¡n</h2>
  <table><thead><tr><th>NgÃ y</th><th>Thu nháº­p</th><th>Ghi chÃº</th></tr></thead><tbody id="tableBody"></tbody></table>
  <div style="text-align:left; padding: 0 20px;">
    <p><strong>Tá»•ng thu nháº­p:</strong> <span id="total"></span></p>
    <p><strong>Sá»‘ dÆ°:</strong> <span id="balance"></span></p>
    <p><strong>Há» tÃªn:</strong> <span id="realName"></span></p>
  </div>
  <button onclick="claimKPI()">Nháº­n thÆ°á»Ÿng KPI</button>
  <button onclick="goHome()">â†©ï¸ Vá» trang chÃ­nh</button>
</div>

<div id="screen3" class="hidden">
  <h2>RÃšT TIá»€N</h2>
  <input id="w_bank" placeholder="NgÃ¢n hÃ ng">
  <input id="w_account" placeholder="Sá»‘ tÃ i khoáº£n">
  <input id="w_amount" placeholder="Sá»‘ tiá»n">
  <textarea id="w_note" placeholder="Ná»™i dung rÃºt"></textarea>
  <button onclick="submitWithdraw()">Gá»¬I ÄI</button>
  <button onclick="goHome()">â†©ï¸ Vá» trang chÃ­nh</button>
</div>

<div id="screen4" class="hidden">
  <h2>CÃ i Ä‘áº·t</h2>
  <label><input type="checkbox" id="musicToggle" onchange="toggleMusic()"> Nháº¡c ná»n</label><br>
  <label><input type="checkbox" id="wakeLockToggle" onchange="toggleWakeLock()"> MÃ n hÃ¬nh luÃ´n sÃ¡ng</label><br>
  <label><input type="button" onclick="clearCache()" value="XoÃ¡ cache táº¡m"></label><br><br>
  <button onclick="goHome()">â†©ï¸ Vá» trang chÃ­nh</button>
</div>

<script>
const API = "https://sheetdb.io/api/v1/ttokf6668h433";
let usernameGlobal = "", lastBalance = 0, wakeLock = null;

function continueToMain() {
  const u = usernameInput.value.trim(), p = passwordInput.value.trim();
  if (!u || !p) return alert("Vui lÃ²ng nháº­p Ä‘á»§ thÃ´ng tin");
  fetch(API + "?sheet=ThuNhap").then(r => r.json()).then(data => {
    const user = data.find(r => r.username === u && r.pass === p);
    if (!user) return alert("Sai thÃ´ng tin Ä‘Äƒng nháº­p");
    usernameGlobal = u;
    loginScreen.classList.add("hidden");
    mainScreen.classList.remove("hidden");
    bgMusic.play();
  });
}

function showIncome() {
  mainScreen.classList.add("hidden");
  screen3.classList.add("hidden");
  screen4.classList.add("hidden");
  screen2.classList.remove("hidden");
  fetch(API + "?sheet=ThuNhap").then(r => r.json()).then(data => {
    const rows = data.filter(r => r.username === usernameGlobal);
    let totalAmount = 0;
    tableBody.innerHTML = "";
    rows.forEach(r => {
      totalAmount += parseFloat(r.amount || 0);
      tableBody.innerHTML += `<tr><td>${r.date}</td><td>${r.amount}</td><td>${r.note}</td></tr>`;
    });
    realName.textContent = rows.at(-1)?.name || "";
    lastBalance = parseFloat(rows.at(-1)?.balance || 0);
    balance.textContent = lastBalance.toLocaleString() + " Ä‘";
    total.textContent = totalAmount.toLocaleString() + " Ä‘";
  });
}

function claimKPI() {
  fetch(API + "?sheet=ThuNhap").then(r => r.json()).then(data => {
    const rows = data.filter(r => r.username === usernameGlobal);
    const unclaimed = rows.filter(r => !r.status || r.status.toLowerCase() !== "done" && !r.note?.toLowerCase().includes("kpi"));
    if (!unclaimed.length) return alert("Báº¡n Ä‘Ã£ nháº­n háº¿t KPI.");
    const total = unclaimed.reduce((s, r) => s + parseFloat(r.amount || 0), 0);
    const bonus = Math.round(total * 0.2), today = new Date().toLocaleDateString("vi-VN");
    const row = [{
      id: Date.now().toString(), username: usernameGlobal, pass: "",
      amount: bonus, date: today, note: "thÆ°á»Ÿng kpi",
      balance: lastBalance + bonus,
      name: rows.find(r => r.name)?.name || "", status: "done"
    }];
    fetch(API + "?sheet=ThuNhap", {
      method: "POST", headers: { "Content-Type": "application/json" }, body: JSON.stringify(row)
    }).then(() => {
      unclaimed.forEach(r => r.id && fetch(API + `/id/${r.id}?sheet=ThuNhap`, {
        method: "PATCH", headers: { "Content-Type": "application/json" }, body: JSON.stringify({ status: "done" })
      }));
      alert(`ÄÃ£ nháº­n ${bonus.toLocaleString()}â‚« KPI`);
      showIncome();
    });
  });
}

function submitWithdraw() {
  const bank = w_bank.value.trim();
  const account = w_account.value.trim();
  const amount = w_amount.value.trim();
  const note = w_note.value.trim();

  if (!bank || !account || !amount || isNaN(amount)) {
    return alert("Vui lÃ²ng nháº­p Ä‘áº§y Ä‘á»§ vÃ  chÃ­nh xÃ¡c thÃ´ng tin rÃºt tiá»n.");
  }

  const data = [{
    time: new Date().toLocaleString("vi-VN"),
    username: usernameGlobal,
    bank: bank,
    account: account,
    amount: amount,
    note: note
  }];

  fetch(API + "?sheet=YeuCauRut", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(data)
  }).then(() => {
    alert("ÄÃ£ gá»­i yÃªu cáº§u rÃºt tiá»n! Vui lÃ²ng chá» duyá»‡t.");
    goHome();
  }).catch(e => alert("Lá»—i gá»­i yÃªu cáº§u: " + e));
}

function openGiftCode() {
  const code = prompt("Nháº­p gift code:");
  if (!code) return;
  fetch(API + "?sheet=Home").then(r => r.json()).then(data => {
    const row = data.find(r => r.giftcode?.trim().toLowerCase() === code.trim().toLowerCase() && (!r.status || r.status !== "done"));
    if (!row) return alert("Code khÃ´ng há»£p lá»‡ hoáº·c Ä‘Ã£ sá»­ dá»¥ng.");
    const rewardList = [
      { value: 10000, chance: 50 },
      { value: 20000, chance: 55 },
      { value: 50000, chance: 70 },
      { value: 100000, chance: 7 },
    ];
    const rand = Math.random() * 100;
    let cumulative = 0, reward = 10000;
    for (const r of rewardList) {
      cumulative += r.chance;
      if (rand <= cumulative) {
        reward = r.value;
        break;
      }
    }
    fetch(API + `/giftcode/${code}?sheet=Home`, {
      method: "PATCH",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ status: "done" }),
    });
    alert(`Báº¡n nháº­n Ä‘Æ°á»£c ${reward.toLocaleString()}â‚«! Chá»¥p mÃ n hÃ¬nh gá»­i admin.`);
  });
}

function openNotification() {
  fetch(API + "?sheet=Home").then(r => r.json()).then(data => {
    const rows = data.filter(r => r.noti);
    if (!rows.length) return alert("KhÃ´ng cÃ³ thÃ´ng bÃ¡o nÃ o.");
    alert("ThÃ´ng bÃ¡o:\n" + rows.map(r => `â€¢ ${r.noti}`).join("\n"));
  });
}

function openEvent() {
  alert("Hiá»‡n táº¡i chÆ°a cÃ³ sá»± kiá»‡n nÃ o.");
}

function showWithdraw() {
  mainScreen.classList.add("hidden");
  screen2.classList.add("hidden");
  screen4.classList.add("hidden");
  screen3.classList.remove("hidden");
}

function showSettings() {
  mainScreen.classList.add("hidden");
  screen2.classList.add("hidden");
  screen3.classList.add("hidden");
  screen4.classList.remove("hidden");
}

function goHome() {
  screen2.classList.add("hidden");
  screen3.classList.add("hidden");
  screen4.classList.add("hidden");
  mainScreen.classList.remove("hidden");
}

function toggleMusic() {
  bgMusic[musicToggle.checked ? "play" : "pause"]();
}

function toggleWakeLock() {
  if ('wakeLock' in navigator && wakeLockToggle.checked) {
    navigator.wakeLock.request('screen').then(lock => wakeLock = lock);
  } else if (wakeLock) {
    wakeLock.release(); wakeLock = null;
  }
}

function clearCache() {
  localStorage.clear();
  alert("ÄÃ£ xoÃ¡ cache");
}
</script>
<script>
let progress = 1;
const loadingText = document.getElementById("loadingText");
const percentText = document.getElementById("loadingPercent");
const splash = document.getElementById("splashScreen");

const splashInterval = setInterval(() => {
  loadingText.innerHTML = `Äang táº£i tiáº¿n trÃ¬nh dá»¯ liá»‡u<br><strong id="loadingPercent">${progress}%</strong>`;
  progress++;

  if (progress > 100) {
    clearInterval(splashInterval);
    splash.style.display = "none";
    document.getElementById("loginScreen").classList.remove("hidden");
  }
}, 50); // 50ms * 100 = 5 giÃ¢y
</script>
<script>
let index = 0;
const sliderTrack = document.getElementById("sliderTrack");
const totalSlides = sliderTrack.children.length;

// Auto slide má»—i 4s
setInterval(() => {
  index = (index + 1) % totalSlides;
  sliderTrack.style.transform = `translateX(-${index * 100}vw)`;
}, 4000);

// Vuá»‘t tay thá»§ cÃ´ng
let startX = 0;
sliderTrack.addEventListener("touchstart", e => startX = e.touches[0].clientX);
sliderTrack.addEventListener("touchend", e => {
  const endX = e.changedTouches[0].clientX;
  if (startX - endX > 50) index = (index + 1) % totalSlides;       // vuá»‘t trÃ¡i
  else if (endX - startX > 50) index = (index - 1 + totalSlides) % totalSlides; // vuá»‘t pháº£i
  sliderTrack.style.transform = `translateX(-${index * 100}vw)`;
});
</script>
</body>
</html>
